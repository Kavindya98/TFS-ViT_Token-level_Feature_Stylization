nohup: ignoring input
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:962: UserWarning: Overwriting vit_small_patch16_224 in registry with domainbed.visiontransformer.vit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:975: UserWarning: Overwriting vit_base_patch16_224 in registry with domainbed.visiontransformer.vit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:987: UserWarning: Overwriting vit_base_patch16_384 in registry with domainbed.visiontransformer.vit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:998: UserWarning: Overwriting vit_base_patch32_384 in registry with domainbed.visiontransformer.vit_base_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1009: UserWarning: Overwriting vit_large_patch16_224 in registry with domainbed.visiontransformer.vit_large_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1020: UserWarning: Overwriting vit_large_patch16_384 in registry with domainbed.visiontransformer.vit_large_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1031: UserWarning: Overwriting vit_large_patch32_384 in registry with domainbed.visiontransformer.vit_large_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1057: UserWarning: Overwriting vit_small_resnet26d_224 in registry with domainbed.visiontransformer.vit_small_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1077: UserWarning: Overwriting vit_base_resnet26d_224 in registry with domainbed.visiontransformer.vit_base_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1087: UserWarning: Overwriting vit_base_resnet50d_224 in registry with domainbed.visiontransformer.vit_base_resnet50d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet50d_224(pretrained=False, **kwargs):
Not launched: ./Results/PACS/RandConv_ViT_Clipped/DeiTBase/t123_s2 ('PACS', 'RandConv_ViT', [1, 2, 3], 0)
1 jobs: 0 done, 0 incomplete, 1 not launched.
python -m domainbed.scripts.train --algorithm RandConv_ViT --data_dir /media/SSD2/Dataset --dataset PACS --holdout_fraction 0.2 --hparams '{"backbone":"DeiTBase","batch_size":32,"lr":5e-05 ,"resnet_dropout":0.0,"weight_decay":0.0,"fixed_featurizer":false,"empty_head":true}' --hparams_seed 0 --output_dir ./Results/PACS/RandConv_ViT_Clipped/DeiTBase/t123_s2 --seed 907770641 --task domain_generalization --test_envs 1 2 3 --trial_seed 2
About to delete 0 jobs.
Good to go
Deleting...
Deleted 0 jobs!
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:962: UserWarning: Overwriting vit_small_patch16_224 in registry with domainbed.visiontransformer.vit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:975: UserWarning: Overwriting vit_base_patch16_224 in registry with domainbed.visiontransformer.vit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:987: UserWarning: Overwriting vit_base_patch16_384 in registry with domainbed.visiontransformer.vit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:998: UserWarning: Overwriting vit_base_patch32_384 in registry with domainbed.visiontransformer.vit_base_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1009: UserWarning: Overwriting vit_large_patch16_224 in registry with domainbed.visiontransformer.vit_large_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1020: UserWarning: Overwriting vit_large_patch16_384 in registry with domainbed.visiontransformer.vit_large_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1031: UserWarning: Overwriting vit_large_patch32_384 in registry with domainbed.visiontransformer.vit_large_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1057: UserWarning: Overwriting vit_small_resnet26d_224 in registry with domainbed.visiontransformer.vit_small_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1077: UserWarning: Overwriting vit_base_resnet26d_224 in registry with domainbed.visiontransformer.vit_base_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1087: UserWarning: Overwriting vit_base_resnet50d_224 in registry with domainbed.visiontransformer.vit_base_resnet50d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet50d_224(pretrained=False, **kwargs):
Not launched: ./Results/PACS/RandConv_ViT_Clipped/DeiTBase/t123_s2 ('PACS', 'RandConv_ViT', [1, 2, 3], 0)
1 jobs: 0 done, 0 incomplete, 1 not launched.
python -m domainbed.scripts.train --algorithm RandConv_ViT --data_dir /media/SSD2/Dataset --dataset PACS --holdout_fraction 0.2 --hparams '{"backbone":"DeiTBase","batch_size":32,"lr":5e-05 ,"resnet_dropout":0.0,"weight_decay":0.0,"fixed_featurizer":false,"empty_head":true}' --hparams_seed 0 --output_dir ./Results/PACS/RandConv_ViT_Clipped/DeiTBase/t123_s2 --seed 907770641 --task domain_generalization --test_envs 1 2 3 --trial_seed 2
About to launch 1 jobs.
Good to go
Launching...
Making job directories:
  0%|          | 0/1 [00:00<?, ?it/s]                                     WARNING: using experimental multi_gpu_launcher.
Environment:
	Python: 3.8.8
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.20.1
	PIL: 8.2.0
Args:
	algorithm: RandConv_ViT
	checkpoint_freq: None
	data_dir: /media/SSD2/Dataset
	dataset: PACS
	holdout_fraction: 0.2
	hparams: {"backbone":"DeiTBase","batch_size":32,"lr":5e-05 ,"resnet_dropout":0.0,"weight_decay":0.0,"fixed_featurizer":false,"empty_head":true}
	hparams_seed: 0
	output_dir: ./Results/PACS/RandConv_ViT_Clipped/DeiTBase/t123_s2
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 907770641
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [1, 2, 3]
	trial_seed: 2
	uda_holdout_fraction: 0
HParams:
	alpha_max: 1.0
	alpha_min: 0.0
	backbone: DeiTBase
	batch_size: 32
	class_balanced: False
	consistency_loss_w: 10.0
	custom_train: 0
	custom_train_val: False
	custom_val: 0
	data_augmentation: False
	digits: True
	empty_fc: False
	empty_head: True
	eval: False
	fixed_featurizer: False
	identity_prob: 0.0
	invariant_loss: True
	lr: 5e-05
	mixing: True
	nonlinear_classifier: False
	randomize_kernel: True
	resnet18: False
	resnet_dropout: 0.0
	test_env: [1, 2, 3]
	weight_decay: 0.0
	weight_decay_d: 0.0
device: cuda
Current cuda device  0
[INFO] NOT Doing Data Augmentation
[INFO] NOT Doing Data Augmentation
[INFO] NOT Doing Data Augmentation
[INFO] NOT Doing Data Augmentation
env  0  :  AA_P  in  1336  out  334
env  1  :  AR  out  2048
env  2  :  C  out  2344
env  3  :  S  out  3929
DeiTBase Network
full_model_tuning_only
1  lengthe of train loader ++++++++++++++++
+ checkpoint_freq: 300
Best model upto now
env0_in_acc   env0_in_loss  env0_out_acc  env0_out_los  env1_out_acc  env1_out_los  env2_out_acc  env2_out_los  env3_out_acc  env3_out_los  epoch         loss          mem_gb        step          step_time     train_acc    
0.1302395210  6.1608985554  0.0898203593  6.2456204096  0.0019531250  6.7267028093  0.0034129693  6.5094632099  0.0005090354  6.7558779101  0.0000000000  6.9698724747  11.101700782  0             2.0748233795  0.0000000000 
Best model upto now
0.9955089820  0.0230171884  0.9850299401  0.0648400853  0.7631835938  1.1947071627  0.5776450512  1.6544911987  0.6477475185  1.4938346109  7.1856287425  0.3951243801  11.983315944  300           1.0543606861  0.9434375000 
Best model upto now
0.9985029940  0.0088596041  0.9970059880  0.0253409772  0.7939453125  1.0353027657  0.5887372014  1.6600554460  0.6057520998  1.5673468920  14.371257485  0.0466665422  11.983315944  600           1.0573270718  0.9978125000 
0.9977544910  0.0040286227  0.9940119760  0.0162620660  0.7714843750  1.2785800993  0.5665529010  1.8827864622  0.5777551540  1.6945812087  21.556886227  0.0553695935  11.983590602  900           1.0562724376  0.9967708333 
0.9970059880  0.0103506866  0.9910179641  0.0140277877  0.7846679688  1.2587711252  0.5720989761  1.7129639450  0.6164418427  1.4969499073  28.742514970  0.0274357276  11.983590602  1200          1.0577152872  0.9984375000 
0.9992514970  0.0019207924  0.9880239521  0.0462701995  0.7207031250  1.7606557757  0.5439419795  2.0234177426  0.5596843981  1.7994400801  35.928143712  0.0456292161  11.983590602  1500          1.0575013487  0.9969791667 
1.0000000000  0.0002258553  0.9880239521  0.0199828104  0.7626953125  1.3948944956  0.5507679181  2.0401892976  0.5576482566  1.8888488777  43.113772455  0.0359488057  11.983590602  1800          1.0580986913  0.9986458333 
0.9992514970  0.0034325096  0.9820359281  0.1241296654  0.7436523438  1.5332923084  0.5081058020  2.4681431432  0.4069737847  2.6929479953  50.299401197  0.0389051512  11.983590602  2100          1.0587960585  0.9977083333 
1.0000000000  0.0002518561  0.9880239521  0.0568255675  0.7343750000  1.6086309403  0.5631399317  2.1432147214  0.5744464240  1.8008786517  57.485029940  0.0080843494  11.983590602  2400          1.0591198699  0.9997916667 
0.9977544910  0.0092192178  0.9880239521  0.0863553088  0.7182617188  1.6442398801  0.5972696246  1.9239329790  0.6052430644  1.6845620986  64.670658682  0.0255329942  11.983590602  2700          1.0583323638  0.9994791667 
1.0000000000  0.0003406986  0.9910179641  0.0613725826  0.7177734375  1.9020477384  0.6305460751  1.8004166013  0.6899974548  1.4243894354  71.856287425  0.0378393719  11.983590602  3000          1.0588432225  0.9982291667 
1.0000000000  0.0002812180  0.9910179641  0.0386554407  0.7216796875  1.8287849054  0.5755119454  2.0229283697  0.6067701705  1.6749808442  79.041916167  0.0448498723  11.983590602  3300          1.0623357050  0.9976041667 
0.9992514970  0.0031659601  0.9880239521  0.0765016618  0.7324218750  1.9301065430  0.5985494881  2.0071721265  0.5713922118  2.1317489762  86.227544910  0.0147963029  11.983590602  3600          1.0629992867  0.9990625000 
1.0000000000  0.0000796577  0.9880239521  0.0341849618  0.7084960938  1.9707803130  0.6023890785  1.8445380926  0.6849071010  1.4012448249  93.413173652  0.0046470143  11.983590602  3900          1.0633184059  0.9998958333 
1.0000000000  0.0000747306  0.9910179641  0.0241044950  0.7377929688  1.6699565277  0.5691126280  1.9958608590  0.6424026470  1.5513267556  100.59880239  0.0101416970  11.983590602  4200          1.0626151450  0.9994791667 
0.9962574850  0.0210776254  0.9880239521  0.0273901479  0.7006835938  1.9356719777  0.5503412969  2.1032544751  0.5752099771  1.7483213025  107.78443113  0.0320227087  11.983590602  4500          1.0636222688  0.9985416667 
0.9992514970  0.0023495648  0.9910179641  0.0509982631  0.7324218750  1.5635905340  0.5644197952  2.0069270950  0.6233138203  1.6274852368  114.97005988  0.0216042894  11.983590602  4800          1.0629484431  0.9989583333 
0.9962574850  0.0132997804  0.9940119760  0.0473075597  0.7324218750  1.8115907609  0.5661262799  2.2059641324  0.6164418427  1.8355135802  119.73652694  0.0371227682  11.983590602  4999          1.0624188047  0.9979585427 
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:962: UserWarning: Overwriting vit_small_patch16_224 in registry with domainbed.visiontransformer.vit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:975: UserWarning: Overwriting vit_base_patch16_224 in registry with domainbed.visiontransformer.vit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:987: UserWarning: Overwriting vit_base_patch16_384 in registry with domainbed.visiontransformer.vit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:998: UserWarning: Overwriting vit_base_patch32_384 in registry with domainbed.visiontransformer.vit_base_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1009: UserWarning: Overwriting vit_large_patch16_224 in registry with domainbed.visiontransformer.vit_large_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1020: UserWarning: Overwriting vit_large_patch16_384 in registry with domainbed.visiontransformer.vit_large_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1031: UserWarning: Overwriting vit_large_patch32_384 in registry with domainbed.visiontransformer.vit_large_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1057: UserWarning: Overwriting vit_small_resnet26d_224 in registry with domainbed.visiontransformer.vit_small_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1077: UserWarning: Overwriting vit_base_resnet26d_224 in registry with domainbed.visiontransformer.vit_base_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1087: UserWarning: Overwriting vit_base_resnet50d_224 in registry with domainbed.visiontransformer.vit_base_resnet50d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet50d_224(pretrained=False, **kwargs):
Launched 1 jobs!

nohup: ignoring input
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:962: UserWarning: Overwriting vit_small_patch16_224 in registry with domainbed.visiontransformer.vit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:975: UserWarning: Overwriting vit_base_patch16_224 in registry with domainbed.visiontransformer.vit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:987: UserWarning: Overwriting vit_base_patch16_384 in registry with domainbed.visiontransformer.vit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:998: UserWarning: Overwriting vit_base_patch32_384 in registry with domainbed.visiontransformer.vit_base_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1009: UserWarning: Overwriting vit_large_patch16_224 in registry with domainbed.visiontransformer.vit_large_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1020: UserWarning: Overwriting vit_large_patch16_384 in registry with domainbed.visiontransformer.vit_large_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1031: UserWarning: Overwriting vit_large_patch32_384 in registry with domainbed.visiontransformer.vit_large_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1057: UserWarning: Overwriting vit_small_resnet26d_224 in registry with domainbed.visiontransformer.vit_small_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1077: UserWarning: Overwriting vit_base_resnet26d_224 in registry with domainbed.visiontransformer.vit_base_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1087: UserWarning: Overwriting vit_base_resnet50d_224 in registry with domainbed.visiontransformer.vit_base_resnet50d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet50d_224(pretrained=False, **kwargs):
Not launched: ./Results/PACS/RandConv_ViT_Clipped/ViTBase/t123_s2 ('PACS', 'RandConv_ViT', [1, 2, 3], 0)
1 jobs: 0 done, 0 incomplete, 1 not launched.
python -m domainbed.scripts.train --algorithm RandConv_ViT --data_dir /media/SSD2/Dataset --dataset PACS --holdout_fraction 0.2 --hparams '{"backbone":"ViTBase","batch_size":32,"lr":5e-05 ,"resnet_dropout":0.0,"weight_decay":0.0,"fixed_featurizer":false,"empty_head":true}' --hparams_seed 0 --output_dir ./Results/PACS/RandConv_ViT_Clipped/ViTBase/t123_s2 --seed 907770641 --task domain_generalization --test_envs 1 2 3 --trial_seed 2
About to delete 0 jobs.
Good to go
Deleting...
Deleted 0 jobs!
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:962: UserWarning: Overwriting vit_small_patch16_224 in registry with domainbed.visiontransformer.vit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:975: UserWarning: Overwriting vit_base_patch16_224 in registry with domainbed.visiontransformer.vit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:987: UserWarning: Overwriting vit_base_patch16_384 in registry with domainbed.visiontransformer.vit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:998: UserWarning: Overwriting vit_base_patch32_384 in registry with domainbed.visiontransformer.vit_base_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1009: UserWarning: Overwriting vit_large_patch16_224 in registry with domainbed.visiontransformer.vit_large_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1020: UserWarning: Overwriting vit_large_patch16_384 in registry with domainbed.visiontransformer.vit_large_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1031: UserWarning: Overwriting vit_large_patch32_384 in registry with domainbed.visiontransformer.vit_large_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1057: UserWarning: Overwriting vit_small_resnet26d_224 in registry with domainbed.visiontransformer.vit_small_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1077: UserWarning: Overwriting vit_base_resnet26d_224 in registry with domainbed.visiontransformer.vit_base_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1087: UserWarning: Overwriting vit_base_resnet50d_224 in registry with domainbed.visiontransformer.vit_base_resnet50d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet50d_224(pretrained=False, **kwargs):
Not launched: ./Results/PACS/RandConv_ViT_Clipped/ViTBase/t123_s2 ('PACS', 'RandConv_ViT', [1, 2, 3], 0)
1 jobs: 0 done, 0 incomplete, 1 not launched.
python -m domainbed.scripts.train --algorithm RandConv_ViT --data_dir /media/SSD2/Dataset --dataset PACS --holdout_fraction 0.2 --hparams '{"backbone":"ViTBase","batch_size":32,"lr":5e-05 ,"resnet_dropout":0.0,"weight_decay":0.0,"fixed_featurizer":false,"empty_head":true}' --hparams_seed 0 --output_dir ./Results/PACS/RandConv_ViT_Clipped/ViTBase/t123_s2 --seed 907770641 --task domain_generalization --test_envs 1 2 3 --trial_seed 2
About to launch 1 jobs.
Good to go
Launching...
Making job directories:
  0%|          | 0/1 [00:00<?, ?it/s]                                     WARNING: using experimental multi_gpu_launcher.
Environment:
	Python: 3.8.8
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.20.1
	PIL: 8.2.0
Args:
	algorithm: RandConv_ViT
	checkpoint_freq: None
	data_dir: /media/SSD2/Dataset
	dataset: PACS
	holdout_fraction: 0.2
	hparams: {"backbone":"ViTBase","batch_size":32,"lr":5e-05 ,"resnet_dropout":0.0,"weight_decay":0.0,"fixed_featurizer":false,"empty_head":true}
	hparams_seed: 0
	output_dir: ./Results/PACS/RandConv_ViT_Clipped/ViTBase/t123_s2
	save_best_model: True
	save_model_every_checkpoint: False
	seed: 907770641
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [1, 2, 3]
	trial_seed: 2
	uda_holdout_fraction: 0
HParams:
	alpha_max: 1.0
	alpha_min: 0.0
	backbone: ViTBase
	batch_size: 32
	class_balanced: False
	consistency_loss_w: 10.0
	custom_train: 0
	custom_train_val: False
	custom_val: 0
	data_augmentation: False
	digits: True
	empty_fc: False
	empty_head: True
	eval: False
	fixed_featurizer: False
	identity_prob: 0.0
	invariant_loss: True
	lr: 5e-05
	mixing: True
	nonlinear_classifier: False
	randomize_kernel: True
	resnet18: False
	resnet_dropout: 0.0
	test_env: [1, 2, 3]
	weight_decay: 0.0
	weight_decay_d: 0.0
device: cuda
Current cuda device  0
[INFO] NOT Doing Data Augmentation
[INFO] NOT Doing Data Augmentation
[INFO] NOT Doing Data Augmentation
[INFO] NOT Doing Data Augmentation
env  0  :  AA_P  in  1336  out  334
env  1  :  AR  out  2048
env  2  :  C  out  2344
env  3  :  S  out  3929
ViTBase Network
full_model_tuning_only
1  lengthe of train loader ++++++++++++++++
+ checkpoint_freq: 300
Best model upto now
env0_in_acc   env0_in_loss  env0_out_acc  env0_out_los  env1_out_acc  env1_out_los  env2_out_acc  env2_out_los  env3_out_acc  env3_out_los  epoch         loss          mem_gb        step          step_time     train_acc    
0.0022455090  6.5753415715  0.0000000000  6.4936289787  0.0043945312  6.8036061823  0.0004266212  7.0044442227  0.0000000000  7.1191965072  0.0000000000  9.1780691147  13.198490619  0             2.0459086895  0.0000000000 
Best model upto now
0.9902694611  0.0285305606  0.9910179641  0.0252561121  0.7382812500  1.1312173270  0.5140784983  1.7243038792  0.3779587681  2.3179936178  7.1856287425  0.5189768240  14.173332214  300           1.0279833857  0.9493750000 
Best model upto now
0.9970059880  0.0196331539  1.0000000000  0.0076667800  0.7719726562  1.0030802302  0.5784982935  1.5262627790  0.5627386103  1.6980609240  14.371257485  0.0735591255  14.174185276  600           1.0293627501  0.9964583333 
0.9977544910  0.0056673485  0.9910179641  0.0148221989  0.7524414062  1.1726787910  0.4283276451  2.9385438467  0.3100025452  3.8170512492  21.556886227  0.0675676366  14.174185276  900           1.0304669992  0.9965625000 
1.0000000000  0.0022616420  0.9790419162  0.0621639189  0.7998046875  0.9365286343  0.6471843003  1.3454677055  0.5981165691  1.5698879073  28.742514970  0.0382033983  14.174185276  1200          1.0294875892  0.9977083333 
0.9992514970  0.0018920738  0.9820359281  0.0672207999  0.7841796875  1.2621657103  0.6727815700  1.3460494374  0.6530923899  1.5861336839  35.928143712  0.0400030087  14.174185276  1500          1.0307596930  0.9983333333 
1.0000000000  0.0004940093  0.9910179641  0.0150355265  0.7822265625  1.2460978813  0.5298634812  2.2375094765  0.5981165691  1.8030938295  43.113772455  0.0389313770  14.174185276  1800          1.0304728627  0.9986458333 
0.9977544910  0.0102169794  0.9700598802  0.1200375408  0.7568359375  1.3107720427  0.6220136519  1.6540316594  0.6121150420  1.8022915932  50.299401197  0.0394921545  14.174185276  2100          1.0300574191  0.9977083333 
1.0000000000  0.0003984054  0.9970059880  0.0094174458  0.7802734375  1.1472488716  0.6377986348  1.5123410350  0.6385848816  1.6170474214  57.485029940  0.0198754191  14.174185276  2400          1.0307612387  0.9993750000 
0.9992514970  0.0018235250  0.9940119760  0.0357468212  0.7548828125  1.3367749751  0.5964163823  1.7862605860  0.6233138203  1.8455950714  64.670658682  0.0230340758  14.174185276  2700          1.0304057614  0.9990625000 
0.9970059880  0.0096689884  0.9940119760  0.0195860603  0.7568359375  1.4165077917  0.5917235495  1.8471347219  0.6497836600  1.7386107675  71.856287425  0.0405372410  14.174185276  3000          1.0337724082  0.9984375000 
0.9970059880  0.0056196277  0.9940119760  0.0356583796  0.7509765625  1.5208518580  0.5401023891  2.5559899054  0.6309493510  2.0578011967  79.041916167  0.0161564575  14.174185276  3300          1.0311509116  0.9997916667 
0.9970059880  0.0083270000  0.9880239521  0.0680799292  0.7636718750  1.4347639829  0.6275597270  1.7021363409  0.6571646729  1.7164264648  86.227544910  0.0169223924  14.174185276  3600          1.0333248623  0.9995833333 
1.0000000000  0.0001062628  0.9850299401  0.0409098961  0.7382812500  1.5520228446  0.6284129693  1.7831310536  0.6370577755  1.9379764180  93.413173652  0.0248656754  14.174185276  3900          1.0322254841  0.9989583333 
0.9985029940  0.0068694685  0.9730538922  0.1642829726  0.7792968750  1.2072269283  0.6356655290  1.6132743861  0.6133876304  1.7945461350  100.59880239  0.0331988888  14.174185276  4200          1.0325331299  0.9984375000 
0.9947604790  0.0277802044  0.9880239521  0.0633829720  0.7416992188  1.5400168896  0.6301194539  1.6237656756  0.6632730975  1.3081789613  107.78443113  0.0444281895  14.174185276  4500          1.0327697380  0.9969791667 
0.9992514970  0.0035266245  0.9940119760  0.0519077170  0.7236328125  2.0680252686  0.5383959044  2.6135687514  0.6113514889  1.8296856611  114.97005988  0.0151440864  14.174185276  4800          1.0339984989  0.9991666667 
1.0000000000  0.0001573067  0.9970059880  0.0105915840  0.7275390625  1.8721195832  0.5469283276  2.5184590879  0.6452023416  1.6598747853  119.73652694  0.0146257950  14.174185276  4999          1.0351344401  0.9992148241 
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:962: UserWarning: Overwriting vit_small_patch16_224 in registry with domainbed.visiontransformer.vit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:975: UserWarning: Overwriting vit_base_patch16_224 in registry with domainbed.visiontransformer.vit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:987: UserWarning: Overwriting vit_base_patch16_384 in registry with domainbed.visiontransformer.vit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:998: UserWarning: Overwriting vit_base_patch32_384 in registry with domainbed.visiontransformer.vit_base_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1009: UserWarning: Overwriting vit_large_patch16_224 in registry with domainbed.visiontransformer.vit_large_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1020: UserWarning: Overwriting vit_large_patch16_384 in registry with domainbed.visiontransformer.vit_large_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch16_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1031: UserWarning: Overwriting vit_large_patch32_384 in registry with domainbed.visiontransformer.vit_large_patch32_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_large_patch32_384(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1057: UserWarning: Overwriting vit_small_resnet26d_224 in registry with domainbed.visiontransformer.vit_small_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_small_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1077: UserWarning: Overwriting vit_base_resnet26d_224 in registry with domainbed.visiontransformer.vit_base_resnet26d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet26d_224(pretrained=False, **kwargs):
/media/SSD2/kavindya/Model/TFS-ViT_Token-level_Feature_Stylization/domainbed/visiontransformer.py:1087: UserWarning: Overwriting vit_base_resnet50d_224 in registry with domainbed.visiontransformer.vit_base_resnet50d_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def vit_base_resnet50d_224(pretrained=False, **kwargs):
Launched 1 jobs!
